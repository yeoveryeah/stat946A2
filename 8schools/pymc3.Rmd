---
title: "Untitled"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## PyMC3

```{r pySteup}
require(reticulate)
use_python("/usr/local/bin/python3")
```


```{python}
import pymc3 as pm 
import numpy as np
import math
import matplotlib.pyplot as plt

y = np.array([28, 8, -3, 7, -1, 1, 18, 12])
sigma = np.array([15, 10, 16, 11, 9, 11, 10, 18])
N = 8

with pm.Model() as hernm:
  # hyperparameter:
  lam = pm.Uniform('lam', lower= -np.inf , upper= np.inf)
  tau2 = pm.InverseGamma('tau2', alpha=1, beta=1)
  tau = pm.Deterministic('tau', math.sqrt(tau2))
  # prior
  mu = pm.Normal('mu', lam, sigma=tau, shape = N)
  # Likelihood
  y = pm.Normal('y', mu, sigma=sigma, observed=y)
  
  trace = pm.sample(500, init='nuts', n_init = 1e4, tune = 5000, chains =4)
  
pm.summary(trace)

```

```{python}
pm.traceplot(trace);
```





