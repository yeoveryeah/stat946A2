install.packages("reticulate")
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
require(rstan)
require(reticulate)
use_python("/usr/local/bin/python3")
Sys.which('python')
require(reticulate)
use_python("/usr/local/bin/python3")
traceplot(py$trace)
require(reticulate)
use_python("/usr/local/bin/python3")
## PyMC3
```{r pySteup}
require(reticulate)
use_python("/usr/local/bin/python3")
```
```{python}
import pymc3 as pm
import numpy as np
import math
import matplotlib.pyplot as plt
y = np.array([28, 8, -3, 7, -1, 1, 18, 12])
sigma = np.array([15, 10, 16, 11, 9, 11, 10, 18])
N = 8
with pm.Model() as hernm:
# hyperparameter:
lam = pm.Uniform('lam', lower= 0 , upper= 1)
tau2 = pm.InverseGamma('tau2', alpha=1, beta=1)
tau = pm.Deterministic('tau', math.sqrt(tau2))
# prior
mu = pm.Normal('mu', lam, sigma=tau, shape = N)
# Likelihood
y = pm.Normal('y', mu, sigma=sigma, observed=y)
trace = pm.sample(500, init='nuts', n_init = 1e4, tune = 5000, chains =4)
pm.summary(trace)
```
```{python}
pm.traceplot(trace);
```
names(knitr::knit_engines$get())
